<ngx-spinner
  bdColor="transparent"
  size="medium"
  color="#fff"
  type="ball-clip-rotate-multiple"
></ngx-spinner>

<app-dialog-header title="Approve Contract">
</app-dialog-header>

<mat-dialog-content>
  <app-infinite-progress-bar
    *ngIf="startProgress"
    [start]="true"
    [end]="finishProgress"
    (finish)="hideProgressbar()"
  >
  </app-infinite-progress-bar>

  <div class="col-sm-12 dialog-padding">
    <div class="row">
      <div class="col-sm-12 col-md-5">
        <div class="title main-h2 marginbottom20">Account Information</div>
        <div class="list-avatar">
          <div class="avatar-container">
            <app-avatar [seed]=account></app-avatar>
          </div>
          <div class="txt-container">
            <div class="subtitle">Wallet address</div>
            <div class="title ellipsis">{{ account }}</div>
          </div>
        </div>
      </div>
      <div class="col-sm-12 col-md-7 px-0">

        <ng-container *ngIf="tokens?.length && !onlyAsset">
          <div class="title main-h2 mb-3 px-3 mx-1">
            Tokens
          </div>
          <ng-container *ngFor="let token of tokens; let i = index">
            <mat-accordion *ngIf="!onlyToken || onlyToken == token.address">
              <mat-expansion-panel
                class="expansion-panel mat-elevation-z"
                [expanded]="onlyToken || i === 0"
              >
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    {{ token.name }}
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div
                  class="checkbox"
                  *ngFor="let operator of token.operators"
                >
                  <mat-checkbox
                    color="primary"
                    [checked]="operator.isApproved | async"
                    (change)="clickCheck(operator, $event, token, 'token')"
                    *ngIf="!onlyAddress || onlyAddress == operator.address"
                  >
                    Authorize the <b>{{ operator.name }}</b> contract to operate {{ token.name }} on your behalf
                  </mat-checkbox>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </ng-container>
        </ng-container>

        <ng-container *ngIf="assets?.length && !onlyToken">
          <div class="title main-h2 mb-3 px-3 mx-1">
            ERC 721
          </div>
          <ng-container *ngFor="let asset of assets">
            <mat-accordion *ngIf="!onlyAsset || onlyAsset == token.address">
              <mat-expansion-panel
                class="expansion-panel mat-elevation-z"
                [expanded]="onlyAsset"
              >
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    {{ asset.name }}
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div
                  class="checkbox"
                  *ngFor="let operator of asset.operators"
                >
                  <mat-checkbox
                    color="primary"
                    [checked]="operator.isApproved | async"
                    (change)="clickCheck(operator, $event, asset, 'asset')"
                    *ngIf="!onlyAddress || onlyAddress == operator.address"
                  >
                    Authorize the <b>{{ operator.name }}</b> contract to operate {{ asset.name }} on your behalf
                  </mat-checkbox>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </ng-container>
        </ng-container>

      </div>
    </div>
    <div class="row mt-4">
      <div class="col-sm-12 d-flex justify-content-end">
        <app-close-button></app-close-button>
      </div>
    </div>
  </div>
</mat-dialog-content>
