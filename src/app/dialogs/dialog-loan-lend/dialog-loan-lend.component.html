<app-dialog-header title="Checkout process">
</app-dialog-header>

<mat-dialog-content class="dialog">

  <ng-container *ngIf="startProgress">
    <app-infinite-progress-bar
      [start]="true"
      [end]="finishProgress"
      (finish)="hideProgressbar()"
    >
    </app-infinite-progress-bar>
  </ng-container>

  <div class="col-sm-12 dialog-padding">
    <div class="title main-h3">
      Select the Currency you want to lend and compare with the other available currencies values.
      <div class="i" matTooltip="The currency rates may vary during the loan terms">
        <i class="far fa-question-circle"></i>
      </div>
    </div>
    <div class="margintop50"></div>
    <div class="row">
      <div class="col-sm-12 col-md-3 title main-h6">
        <div class="row title-3">
          LENDING CURRENCY
        </div>
        <div class="row">
          <mat-form-field>
            <mat-label *ngIf="!lendCurrency" id="label">
              Select Token
            </mat-label>
            <mat-select [(value)]="lendCurrency" (selectionChange)="onChangeCurrency()">
              <mat-option *ngFor="let item of availableCurrencies" [value]="item.symbol">
                <div class="row align-items-center">
                  <div class="icon-box item">
                    <img matPrefix class="input-icon" [src]="item.img">
                  </div>
                  <div class="currency">
                    {{ item.symbol }}
                  </div>
                </div>
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <div class="col-sm-1"></div>
      <div class="col-sm-8">
        <div class="small-table-row row">
          <div class="col title-3 --auto pl-0 uppercase">
            Lending amount
          </div>
          <div class="col-sm-1 no-gutters --auto"></div>
          <div class="col title-3 --auto uppercase">
            {{ isRequest || isCanceled ? 'Estimated return' : 'Return' }}
          </div>
        </div>
        <div class="margintop15"></div>
        <div class="small-table-row --highlight row">
          <div class="col --auto no-pad-left --data-margin data-style">
            <span>
              {{ lendAmount }}
            </span>
            <span class="data--currency-style">
              {{ lendCurrency || '-' }}
            </span>
          </div>
          <div class="col-sm-1 no-gutters --auto"></div>
          <div class="col --auto --data-margin data-style">
            <span>
              {{ lendExpectedReturn }}
            </span>
            <span class="data--currency-style">
              {{ lendCurrency ? 'RCN' : '-' }}
            </span>
            <div
              class="d-inline"
              matTooltip="Expected return"
              *ngIf="lendCurrency && expectedReturnWarning"
            >
              <i class="fas fa-exclamation-triangle margin-left triangle"></i>
            </div>
          </div>
        </div>
        <div class="margintop10"></div>
        <div class="small-table-row row">
          <div class="col title-2 --auto no-pad-left --data-margin baseline">
            <div class="--auto">
              <span class="--lend-amount">
                {{ loanAmount }}
              </span>
              <span class="margin-left">
                {{ loan.currency }}
              </span>
            </div>
          </div>
          <div class="col-sm-1 no-gutters --auto vertical-center">
            <i class="fas fa-arrow-right"></i>
          </div>
          <div class="col title-2 --auto --data-margin wrap baseline">
            <div class="--auto wrap end">
              <span id="label" class="--return-amount">
                {{ loanExpectedReturn }}
              </span>
              <span class="margin-left">
                {{ loan.currency }}
              </span>
              <div
                class="d-inline"
                matTooltip="Guaranteed return"
                *ngIf="lendCurrency"
              >
                <i class="fas fa-check-circle check margin-left"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="margintop-30 mobile"></div>
  <div class="margintop50"></div>
  <div class="mobile"></div>

  <div class="exchange">
    <div>
      <div class="rate d-flex align-items-center padding-2">
        <span class="mr-1">
          Exchange Rate 1 {{ loan.currency }}
        </span>
        <span class="mr-1" *ngIf="loan.currency.toString() !== 'RCN'">
          = {{ exchangeRcn }} RCN
        </span>
        <ng-container *ngIf="exchangeToken && loan.currency.toString() !== lendCurrency">
          <span>
            = {{ exchangeToken }} {{ lendCurrency }}
          </span>
          <i
            class="material-icons ml-2"
            matTooltip="Lorem ipsum dolor sit amet"
          >
            info
          </i>
        </ng-container>
      </div>
    </div>
  </div>

  <div class="margintop20"></div>

  <div class="dialog-footer row padding justify-content-between align-items-center">
    <div class=" col-sm-12 col-md-6 inline account">
      Lending from your {{ account }} account.
    </div>
    <div class="col-sm-12 col-md-6 px-0">
      <div class="row justify-content-end no-gutters">
        <div class="col-sm-12 col-md-3">
          <!-- TODO: implement [disabled] -->
          <app-lend-button
            [loan]="loan"
            [lendToken]="lendToken"
            (startLend)="showProgressbar()"
            (endLend)="finishProgress = true"
            *ngIf="canLend"
          ></app-lend-button>
        </div>
        <div class="d-none d-md-block col-sm-0 col-md-3 ml-2">
          <app-close-button></app-close-button>
        </div>
      </div>
    </div>
  </div>

  <div class="margintop20"></div>
</mat-dialog-content>
