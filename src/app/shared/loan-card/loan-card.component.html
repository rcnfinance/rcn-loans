<div class="loan-card mat-elevation-z5">
  <div
    class="loan-card__header d-flex justify-content-between align-items-start"
  >
    <div>
      <app-loan-avatar [loan]=loan [short]=true></app-loan-avatar>
    </div>
    <div class="d-flex align-items-center">
      <app-risk-indicator
        class="loan-card__header-risk-indicator"
        [loan]="loan"
      ></app-risk-indicator>
      <button
        mat-icon-button
        [matMenuTriggerFor]="appMenu"
        class="loan-card__header-options"
        *ngIf="isBorrower"
      >
        <mat-icon>more_vert</mat-icon>
      </button>
    </div>
  </div>

  <app-creator-container [loan]=loan></app-creator-container>

  <div class="loan-card__content">
    <div class="loan-card__property">
      <div class="loan-card__property-title">
        Installments
      </div>
      <div class="loan-card__property-paragraph">
        {{ installments }}
      </div>
    </div>
    <div class="loan-card__property">
      <div class="loan-card__property-title">
        {{ durationLabel }}
      </div>
      <div class="loan-card__property-paragraph">
        {{ durationValue }}
      </div>
    </div>
    <div class="loan-card__property">
      <div class="loan-card__property-title">
        Annual Interest / Punitory
      </div>
      <div class="loan-card__property-paragraph">
        ~ {{ interestRate }} % /  ~ {{ punitiveInterestRateRate }} %
      </div>
    </div>
    <div class="loan-card__property loan-card__property--properties">
      <div class="loan-card__property-title">
        {{ leftLabel }}
      </div>
      <div class="loan-card__property-currency">
        {{ loan.currency }}
      </div>
      <div class="loan-card__property-title">
        {{ rightLabel }}
      </div>
    </div>
    <div class="loan-card__property loan-card__property--conversion">
      <div
        class="loan-card__property-title"
        [matTooltip]="leftValue?.length > 6 ? leftValue : ''"
        matTooltipPosition="below"
      >
        {{ leftValue }}
      </div>
      <div class="loan-card__property-currency">
        <i class="material-icons" style="font-size: 2em">arrow_forward</i>
      </div>
      <div
        class="loan-card__property-title"
        [matTooltip]="rightValue?.length > 6 ? rightValue : ''"
        matTooltipPosition="below"
      >
        {{ rightValue }}
      </div>
    </div>
    <app-lend-button
      [loan]="loan"
      [showLendDialog]="true"
      (endLend)="onUserAction('lend')"
      *ngIf="canLend"
    >
    </app-lend-button>
    <app-detail-button [loan]=loan></app-detail-button>
  </div>
</div>

<mat-menu #appMenu="matMenu" yPosition="below">
  <button
    mat-menu-item
    *ngFor="let button of loanActions"
    (click)="button.handler"
    [disabled]="button.disabled"
  >
    <span>
      {{ button.title }}
    </span>
  </button>
</mat-menu>
